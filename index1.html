<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8">
  <title>Test Commentaires</title>
  <link href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css" rel="stylesheet">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.5/font/bootstrap-icons.css">
</head>
<body class="bg-light p-5">

 <div class="container mt-4">
  <!-- POST 1 -->
  <div class="card mb-3" data-post-id="post_1">
    <div class="card-body">
      <h5>Publication #1</h5>
      <ul class="list-group mb-2 comment-list"></ul>
      <div class="input-group">
        <input type="text" class="form-control comment-input" placeholder="Commenter...">
        <div class="input-group-append">
          <button class="btn btn-primary comment-submit" type="button">
            <i class="bi bi-send"></i>
          </button>
        </div>
      </div>
    </div>
  </div>

  <!-- POST 2 -->
  <div class="card mb-3" data-post-id="post_2">
    <div class="card-body">
      <h5>Publication #2</h5>
      <ul class="list-group mb-2 comment-list"></ul>
      <div class="input-group">
        <input type="text" class="form-control comment-input" placeholder="Commenter...">
        <div class="input-group-append">
          <button class="btn btn-primary comment-submit" type="button">
            <i class="bi bi-send"></i>
          </button>
        </div>
      </div>
    </div>
  </div>
</div>

<div class="carousel-item d-flex justify-content-center align-items-center" style="background-color: #f8f9fa;">
  <button class="btn btn-outline-secondary rounded-circle" style="width: 60px; height: 60px;" onclick="document.getElementById('carouselInput').click();">
    <i class="bi bi-plus" style="font-size: 1.5rem;"></i>
  </button>
  <input type="file" accept="image/*" id="carouselInput" class="d-none" onchange="addCarouselImage(event)">
</div>



<br>
<div class="carousel-item d-flex justify-content-center align-items-center bg-light">
  <button onclick="document.getElementById('carouselInput').click();"
          class="btn p-0 border-0 shadow-none"
          style="background: transparent; width: 40px; height: 40px;">
    <i class="bi bi-plus-circle" style="font-size: 1.8rem; color: #007bff;"></i>
  </button>
  <input type="file" accept="image/*" id="carouselInput" class="d-none" onchange="addCarouselImage(event)">
</div>





 <div class="card shadow-sm">
          <div class="card-header bg-white">
            <h5 class="mb-0"><i class="fas fa-user mr-2"></i>NELLA dec</h5>
          </div>
          <div class="card-body p-0">
            <h6 class="card-subtitle mb-2 text-muted"></h6>
            <p class="card-text">
              <!-- contenu de la publication -->
                
              <em>✨Un Printemps à Sakura Gakuen

C’est la fin de l’après-midi au lycée Sakura. La lumière dorée traverse les fenêtres de la classe 2-B pendant que les élèves rangent doucement leurs affaires. Les rires fusent dans le couloir, les fenêtres vibrent légèrement sous les cris d’un match de basket dans la cour. Sur un banc sous les cerisiers, Haruki attend timidement que Mika sorte du club de dessin. Il tient dans ses mains un petit carnet — ses pensées du jour, où chaque page est dédiée à l’émotion qu’elle lui inspire.

Autour d’eux, la vie s’écoule lentement, comme une chanson discrète. C’est un de ces jours simples où rien ne change... et pourtant tout commence.</p>
               <div class="embed-responsive embed-responsive-1by1" style="max-width: 100px; margin: auto;">
                <img src="/assets/image/mangas1.png" class="embed-responsive-item img-fluid rounded" alt="Publication">
              </div>
          </div>
        <!-- systeme de gestion de like et commentaire  -->
          <div class="btn-group" role="group">
              <!-- bouton  like/deslike et commentaires -->
                 <div class="d-flex justify-content-start gap-2 mb-2">
                       <button id="btnlike" type="button" class="btn btn-outline-primary">
                        <i class="bi bi-hand-thumbs-up"></i>
                       </button>
                      <button id="btndislike" type="button" class="btn btn-outline-primary">
                          <i class="bi bi-hand-thumbs-down"></i>
                      </button>
                      <button id="togglebtn" class="btn btn-secondary">
                      <i class="bi bi-chat-dots"></i>
                      </button>
                 </div> 
                    <!-- partie commentaire cachée -->
                <div id="commentSection" class="collapse" data-post-id="post1">
                    <!-- liste des commentaire cachée -->
                     <div class="card-body">
                         <ul  id="Listcomment" class="list-group mb-3"></ul>
                     </div>
                    <!-- champ du commentaire  -->
                    <div class="input-group">
                        <input id="commentinput" type="text"  class="form-control" placeholder="Ajouter un commentaire...">
                        <!-- button d'envoie du commentaire -->
                         <div class="input-group-append">
                               <button id="commentsubmit" class="btn btn-secondary" type="button"><i class="bi bi-send"></i></button>
                         </div>
                    </div>
                </div>
            </div>
        </div>
  <script>


document.addEventListener("DOMContentLoaded", () => {
  const posts = document.querySelectorAll("[data-post-id]");

  posts.forEach(post => {
    const postId = post.getAttribute("data-post-id");
    const input = post.querySelector(".comment-input");
    const button = post.querySelector(".comment-submit");
    const list = post.querySelector(".comment-list");

    let comments = JSON.parse(localStorage.getItem(postId)) || [];

    const render = () => {
      list.innerHTML = "";
      comments.forEach((cmt, index) => {
        const li = document.createElement("li");
        li.className = "list-group-item d-flex justify-content-between align-items-center";
        li.innerHTML = `
          <span>${cmt}</span>
          <button class="btn btn-sm btn-danger"><i class="bi bi-trash"></i></button>
        `;
        li.querySelector("button").addEventListener("click", () => {
          comments.splice(index, 1);
          localStorage.setItem(postId, JSON.stringify(comments));
          render();
        });
        list.appendChild(li);
      });
    };

    button.addEventListener("click", () => {
      const value = input.value.trim();
      if (value !== "") {
        comments.push(value);
        localStorage.setItem(postId, JSON.stringify(comments));
        input.value = "";
        render();
      }
    });

    render();
  });
});


// inserssion de l'image 

function addCarouselImage(event) {
  const file = event.target.files[0];
  if (!file) return;

  const reader = new FileReader();
  reader.onload = function(e) {
    const carouselInner = document.querySelector("#carousel .carousel-inner");

    const newItem = document.createElement("div");
    newItem.className = "carousel-item";
    newItem.innerHTML = `<img src="${e.target.result}" class="d-block w-100 rounded shadow-sm" alt="Image ajoutée">`;

    // Insère juste avant le bouton "Ajouter"
    const addButton = carouselInner.lastElementChild;
    carouselInner.insertBefore(newItem, addButton);
  };
  reader.readAsDataURL(file);
}








//pour ajoute le non du use et la date ainsi que l'heure 
//   document.addEventListener("DOMContentLoaded", () => {
//   const posts = document.querySelectorAll("[data-post-id]");

//   posts.forEach(post => {
//     const postId = post.getAttribute("data-post-id");
//     const input = post.querySelector("#commentinput");
//     const submit = post.querySelector("#commentsubmit");
//     const commentList = post.querySelector("#Listcomment");

//     // Charger les commentaires depuis localStorage
//     let comments = JSON.parse(localStorage.getItem(`comments_${postId}`)) || [];

//     function formatTime(date) {
//       return date.toLocaleTimeString([], { hour: "2-digit", minute: "2-digit" });
//     }

//     function renderComments() {
//       commentList.innerHTML = "";
//       comments.forEach((comment, index) => {
//         const li = document.createElement("li");
//         li.className = "list-group-item d-flex justify-content-between align-items-start";

//         li.innerHTML = `
//           <div>
//             <strong>${comment.author}</strong>
//             <small class="text-muted ml-2">${comment.time}</small>
//             <p class="mb-0">${comment.text}</p>
//           </div>
//           <button class="btn btn-sm btn-danger ml-2"><i class="bi bi-trash"></i></button>
//         `;

//         const deleteBtn = li.querySelector("button");
//         deleteBtn.addEventListener("click", () => {
//           // Animation + suppression
//           li.classList.add("fade", "show");
//           setTimeout(() => {
//             comments.splice(index, 1);
//             localStorage.setItem(`comments_${postId}`, JSON.stringify(comments));
//             renderComments();
//           }, 300);
//         });

//         commentList.appendChild(li);
//       });
//     }

//     submit.addEventListener("click", () => {
//       const text = input.value.trim();
//       if (text !== "") {
//         const comment = {
//           text: text,
//           author: "User", // Change ici si tu as un nom dynamique à afficher
//           time: formatTime(new Date())
//         };
//         comments.push(comment);
//         localStorage.setItem(`comments_${postId}`, JSON.stringify(comments));
//         input.value = "";
//         renderComments();
//       }
//     });

//     renderComments();
//   });
// });


  </script>
</body>
</html>
